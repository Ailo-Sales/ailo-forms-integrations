<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ailo Forms Integrations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .state-path {
            cursor: pointer;
            transition: fill 0.2s ease;
            stroke: #ffffff;
            stroke-width: 1;
            fill: #d1d5db; /* Darker gray default fill */
        }
        .state-path:hover {
            filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.1));
            fill: #E61C5D; /* Vibrant Ailo pink on hover */
        }
        #aust-map {
            width: 100%;
            height: auto;
            display: block;
        }
        /* Hide all circle and text elements within the loaded SVG by default */
        #map-container svg circle, 
        #map-container svg text,
        #map-container svg g[id='points'],
        #map-container svg g[id='label_points'] {
            display: none;
        }
        /* Except the ACT circle which is a state-path */
        #map-container svg circle.state-path {
            display: inline;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col font-sans">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 py-6 px-8 shadow-sm">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <h1 class="text-2xl font-extrabold text-gray-900 tracking-tight">Ailo Forms Integrations</h1>
            <div class="text-sm font-medium text-gray-400 uppercase tracking-widest text-gray-400">Internal Use Only</div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-[1600px] mx-auto w-full p-8 flex flex-col lg:flex-row gap-8 items-start">
        
        <!-- Left: Dynamic Professional SVG Map (70%) -->
        <div id="map-container" class="lg:w-[70%] w-full bg-white rounded-3xl p-10 shadow-sm border border-gray-100 flex items-center justify-center min-h-[600px]">
            <!-- map.svg will be loaded here dynamically by JavaScript -->
        </div>

        <!-- Right: Provider Details (30%) -->
        <aside id="sidebar" class="lg:w-[30%] w-full sticky top-8">
            <div class="bg-white p-10 rounded-3xl shadow-xl border border-pink-50 min-h-[500px] flex flex-col">
                <h2 class="text-2xl font-bold text-gray-900 mb-8 flex items-center">
                    <span class="w-2 h-8 bg-pink-600 rounded-full mr-4"></span>
                    Provider Details
                </h2>
                
                <div id="placeholder-text" class="flex-grow flex flex-col items-center justify-center text-center px-4">
                    <div class="w-20 h-20 bg-gray-50 rounded-full flex items-center justify-center mb-6">
                        <svg class="w-10 h-10 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122"></path></svg>
                    </div>
                    <p class="text-gray-400 text-lg font-medium">Select a state on the map to view regional form providers.</p>
                </div>

                <div id="details-view" class="hidden flex-grow flex flex-col animate-in slide-in-from-right-4 duration-500">
                    <div class="mb-10">
                        <p class="text-xs uppercase tracking-[0.2em] text-pink-500 font-black mb-3">Selected Territory</p>
                        <h3 id="state-name" class="text-4xl font-extrabold text-gray-900"></h3>
                    </div>
                    
                    <div class="mb-12 p-6 bg-pink-50 rounded-2xl border border-pink-100">
                        <p class="text-xs uppercase tracking-[0.2em] text-pink-400 font-black mb-3">Primary Provider</p>
                        <p id="provider-name" class="text-2xl text-pink-900 font-bold"></p>
                    </div>
                    
                    <div class="mt-auto">
                        <a id="visit-btn" href="#" target="_blank" class="flex items-center justify-center w-full bg-pink-600 hover:bg-pink-700 text-white font-bold py-5 px-8 rounded-2xl transition-all transform hover:-translate-y-1 shadow-2xl shadow-pink-200">
                            Open Provider Website
                            <svg class="w-6 h-6 ml-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </aside>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 py-20 px-8 mt-12 text-white">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-3xl font-bold mb-8">DocuSign and FormsLiveSign</h2>
            <div class="grid grid-cols-1 gap-6">
                <p class="text-gray-400 text-lg leading-relaxed mb-6">
                    DocuSign and REI FormsLiveSign are two digital signing providers that is fully integrated to Ailo Projects. 
                    Using these tools mean you can track signatures right from within the Projects view. 
                    REI FormsLiveSign might be available for you to use depending on the state you are in.
                </p>
                <p class="text-gray-400 text-lg leading-relaxed">
                    This is the recommended solution and works seamlessly as part of REI Forms, Realworks or Forms Live. 
                    Alternatively, you can use DocuSign which also works with Ailo Projects. The choice is yours! 
                    Regardless of your choice, these signing tools will automatically work with Ailo when you are connect your forms tool.
                    No additional steps are required.
                </p>
            </div>
        </div>
    </footer>

    <script>
        const stateData = {
            'NSW': { name: 'New South Wales', provider: 'REI Forms Live', url: 'https://www.reiformslive.com.au/' },
            'QLD': { name: 'Queensland', provider: 'Realworks', url: 'https://realworks.com.au/' },
            'VIC': { name: 'Victoria', provider: 'Forms Live', url: 'https://www.formslive.com.au/' },
            'WA': { name: 'Western Australia', provider: 'REI Forms Live', url: 'https://members.reiwa.com.au/s/products/rei-forms-live' },
            'SA': { name: 'South Australia', provider: 'REI Forms Live', url: 'https://www.formslive.com.au/south-australia' },
            'NT': { name: 'Northern Territory', provider: 'REI Forms Live', url: 'https://reint.com.au/members/membership-options' },
            'ACT': { name: 'Australian Capital Territory', provider: 'REI Forms Live', url: 'https://www.reiact.com.au/rei-live-form/' },
            'TAS': { name: 'Tasmania', provider: 'REI Forms Live', url: 'https://reit.com.au/members/become-a-reit-member/' }
        };

        const sidebarPlaceholder = document.getElementById('placeholder-text');
        const detailsView = document.getElementById('details-view');
        const stateNameEl = document.getElementById('state-name');
        const providerNameEl = document.getElementById('provider-name');
        const visitBtn = document.getElementById('visit-btn');

        let lockedState = null;

        // Map AU-prefixed IDs to standard state codes
        const auIdToStateCode = {
            'AUNSW': 'NSW',
            'AUVIC': 'VIC',
            'AUQLD': 'QLD',
            'AUWA': 'WA',
            'AUSA': 'SA',
            'AUTAS': 'TAS',
            'AUNT': 'NT',
            'AUACT': 'ACT'
        };

        function updateSidebar(stateCode, isClick = false) {
            const data = stateData[stateCode];
            if (!data) return;

            sidebarPlaceholder.classList.add('hidden');
            detailsView.classList.remove('hidden');

            stateNameEl.textContent = data.name;
            providerNameEl.textContent = data.provider;
            visitBtn.href = data.url;

            if (isClick) {
                document.querySelectorAll('.state-path').forEach(p => {
                    p.style.fill = '#d1d5db'; /* Revert to default fill */
                    p.classList.remove('active');
                });
                const targetAuId = Object.keys(auIdToStateCode).find(key => auIdToStateCode[key] === stateCode);
                const target = document.getElementById(targetAuId); 
                if (target) {
                    target.style.fill = '#E61C5D'; // Ailo pink
                    target.classList.add('active');
                }
                lockedState = stateCode;
            }
        }

        // Function to set up event listeners on loaded SVG paths
        function setupSvgInteractivity() {
            document.querySelectorAll('#map-container svg .state-path').forEach(path => {
                // Get standard state code by stripping 'AU' prefix
                const auId = path.id;
                const stateCode = auId.replace('AU', ''); // Converts 'AUVIC' to 'VIC'

                // Ensure the stateCode exists in stateData
                if (stateData[stateCode]) {
                    // Remove hardcoded fill/stroke attributes from the SVG paths
                    path.removeAttribute('fill');
                    path.removeAttribute('stroke');
                    path.removeAttribute('style'); // Remove inline style to ensure CSS takes precedence

                    path.addEventListener('mouseenter', () => {
                        if (lockedState !== stateCode) { // Only change fill if not the locked state
                            path.style.fill = '#E61C5D'; /* Vibrant Ailo pink on hover */
                            updateSidebar(stateCode);
                        }
                    });
                    
                    path.addEventListener('mouseleave', () => {
                        if (lockedState !== stateCode) { // Only revert fill if not the locked state
                            path.style.fill = '#d1d5db'; /* Darker gray default fill */
                            sidebarPlaceholder.classList.remove('hidden');
                            detailsView.classList.add('hidden');
                        }
                    });
                    
                    path.addEventListener('click', (e) => {
                        e.stopPropagation();
                        updateSidebar(stateCode, true);
                    });
                }
            });

            // Handle clicks outside states to unlock and reset fill
            document.getElementById('map-container').addEventListener('click', (e) => {
                if (!e.target.closest('.state-path')) { // If click is not on a state path
                    lockedState = null;
                    document.querySelectorAll('.state-path').forEach(p => {
                        p.style.fill = '#d1d5db'; /* Darker gray default fill */
                        p.classList.remove('active');
                    });
                    sidebarPlaceholder.classList.remove('hidden');
                    detailsView.classList.add('hidden');
                }
            });
        }

        // Dynamic viewBox Calibration and SVG loading
        document.addEventListener('DOMContentLoaded', () => {
            const mapContainer = document.getElementById('map-container');

            fetch('map.svg')
                .then(response => response.text())
                .then(svgData => {
                    mapContainer.innerHTML = svgData;

                    const svg = mapContainer.querySelector('svg');
                    // Remove any existing hardcoded width/height attributes from the loaded SVG
                    svg.removeAttribute('width');
                    svg.removeAttribute('height');
                    // Set necessary attributes for responsiveness and identification
                    svg.setAttribute('id', 'aust-map');
                    svg.setAttribute('class', 'w-full h-auto block');
                    svg.setAttribute('preserveAspectRatio', 'xMidYMid meet');

                    // Calibrate viewBox
                    const bbox = svg.getBBox();
                    svg.setAttribute('viewBox', `${bbox.x} ${bbox.y} ${bbox.width} ${bbox.height}`);

                    // Add state-path class to all relevant paths and circles for styling and interactivity
                    // This assumes all relevant geographical features are <path> or <circle> elements directly under <svg> or within <g id="features">
                    svg.querySelectorAll('path, circle').forEach(el => {
                        if (el.id && el.id.startsWith('AU')) {
                            el.classList.add('state-path');
                        }
                    });

                    // Hide all elements not part of state paths (labels, points, etc.)
                    // Ensure the ACT circle (if it's a state-path) is not hidden by this general rule
                    svg.querySelectorAll('circle:not(.state-path), text, g[id="points"], g[id="label_points"]').forEach(el => {
                        el.style.display = 'none';
                    });
                    
                    setupSvgInteractivity();
                })
                .catch(error => console.error('Error loading map.svg:', error));
        });
    </script>
</body>
</html>
